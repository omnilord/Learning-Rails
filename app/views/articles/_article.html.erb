<div class="row">
  <div class="panel panel-success">
    <div class="panel-heading">
      <h4><%= link_to article.title, article_path(article) %></h4>
      <small class="author">
        by: <%= link_to article.user.username, user_path(article.user) %>
        <span class="timing">
          <%= time_ago_in_words(article.created_at) %> ago
          <% if article.created_at != article.updated_at %>
          (Last Updated: <%= time_ago_in_words(article.updated_at) %> ago)
          <% end %>
        </span>
        <div class="tags pull-right">
          Tags: <span style="font-style: italic;">
          <% if article.tags.any? %>
            <%= article.tags.map { |tag| link_to(tag, tag_path(tag)).html_safe }.join(', ').html_safe %>
          <% else %>
            No Tags
          <% end %>
          </span>
        </div>
      </small>
    </div>
    <% if article.comments.any? %>
    <% # @ToDo: Add in the comment rendering stuff %>
    <% end %>
    <div class="panel-body">
      <%= (preview ||= false) ? truncate(sanitize(article.body, tags: []), length: 100) : sanitize(article.body, tags: %w[strong em blockquote]).gsub(/\n/, '<br/>').html_safe %>
    </div>
    <div class="panel-footer">
      <small><%= "#{pluralize(article.comments.size, 'Comment')}" %></small>
      <% unless preview %>
        <div class="actions pull-right">
          <% if edit_allowed? article.user_id %>
            <%= link_to 'Edit', edit_article_path(article),
                        class: 'btn btn-xs btn-primary',
                        style: 'color: white;' %>
            &nbsp;
          <% end %>
          <% if destroy_allowed? article.user_id %>
            <%= link_to 'Delete', article_path(article), method: :delete,
                        class: 'btn btn-xs btn-danger',
                        style: 'color: white;',
                        data: { confirm: 'Are you sure?' } %>
            &nbsp;
          <% end %>
          <%= link_to 'Comment', new_comment_path(article),
                      class: 'btn btn-xs btn-success',
                      style: 'color: white;' %>
          &nbsp;
        </div>
      <% end %>
    </div>
  </div>
</div>
